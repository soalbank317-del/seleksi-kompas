<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>KOMPAS</title>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --shopee-orange: #ee4d2d;
      --shopee-orange-dark: #d7391c;
      --text-dark: #212121;
      --text-muted: #757575;
      --bg-light: #f5f5f5;
      --white: #ffffff;
    }
    *{box-sizing:border-box;}
    body{
      margin:0; font-family:"Open Sans",sans-serif; background:var(--bg-light); color:var(--text-dark);
    }

    /* HEADER ala Shopee */
    header{
      background:var(--white);
      box-shadow:0 1px 4px rgba(0,0,0,0.08);
      padding:10px 20px;
      position:sticky; top:0; z-index:50;
      display:flex; align-items:center; justify-content:center;
    }
    .header-container{
      width:100%; max-width:1200px;
      display:flex; align-items:center; justify-content:space-between;
      gap:16px;
    }
    .logo-text{
      color:var(--shopee-orange); font-weight:800; font-size:22px; cursor:pointer;
      text-transform:uppercase; letter-spacing:0.5px;
    }

    /* SEARCH BAR ala Shopee */
    form.search {
      display:flex; align-items:center;
      flex:1;
      max-width:680px;
      border:1.5px solid var(--shopee-orange);
      border-radius:6px;
      background:var(--white);
      overflow:hidden;
    }
    .search input{
      flex:1; border:0; outline:none;
      padding:10px 12px; font-size:14.5px;
    }
    .search button{
      background:var(--shopee-orange); color:var(--white);
      border:0; padding:10px 20px; font-weight:600;
      cursor:pointer; transition:background .2s;
    }
    .search button:hover{ background:var(--shopee-orange-dark); }

    /* MAIN */
    main{ max-width:1200px; margin:24px auto; padding:0 16px 50px; }
    .results{
      display:grid; grid-template-columns:repeat(4,1fr); gap:18px;
    }
    @media(max-width:1100px){ .results{ grid-template-columns:repeat(3,1fr);} }
    @media(max-width:800px){ .results{ grid-template-columns:repeat(2,1fr);} }
    @media(max-width:500px){ .results{ grid-template-columns:1fr;} }

    /* CARD ala Shopee */
    .card{
      background:var(--white);
      border-radius:6px;
      overflow:hidden;
      box-shadow:0 1px 4px rgba(0,0,0,0.08);
      transition:transform .18s ease, box-shadow .18s ease;
      cursor:pointer; display:flex; flex-direction:column; align-items:center;
    }
    .card:hover{ transform:translateY(-4px); box-shadow:0 4px 12px rgba(0,0,0,0.12); }

    .icon{
      font-size:46px; margin-top:22px; color:var(--shopee-orange);
    }
    .card-content{
      padding:12px 14px; text-align:center; flex:1; display:flex; flex-direction:column; justify-content:center;
    }
    .name{
      font-weight:600; font-size:14px; color:var(--text-dark);
      margin-bottom:4px; word-break:break-word;
    }
    .jenis{
      font-size:13px; color:var(--text-muted);
    }
    .open-btn{
      background:var(--shopee-orange); color:#fff;
      padding:7px 14px; border-radius:4px;
      font-size:13px; font-weight:600;
      text-decoration:none; display:inline-block;
      margin:10px 0 14px;
      transition:background .2s;
    }
    .open-btn:hover{ background:var(--shopee-orange-dark); }

    .empty{
      text-align:center; color:var(--text-muted);
      padding:60px 0; font-size:15px;
    }
    mark.hi{
      background:#ffebd8; padding:0 .14em; border-radius:2px;
    }

    footer{
      text-align:center; color:var(--text-muted);
      margin-top:30px; font-size:13px;
    }
  </style>
</head>
<body>
<header>
  <div class="header-container">
    <div class="logo-text">KOMPAS</div>
    <form class="search" onsubmit="event.preventDefault(); doSearch();">
      <input id="q" type="search" placeholder="Cari produk, dokumen, atau nama file‚Ä¶" aria-label="Cari">
      <button type="submit">üîç</button>
    </form>
  </div>
</header>

<main>
  <div id="results" class="results"></div>
  <div id="empty" class="empty" style="display:none;">Tidak ada file yang cocok.</div>
  <footer id="footer">Menampilkan 0 file | @pacegondes 2025</footer>
</main>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR6rCTCroxyDZkOOXfHI7AFeJ-BSYgunwFNuKoazYuPrmH7zcP1-rrXPNcdJ06HO6zzL_Kj8TlV-xNL/pub?output=csv";
let dataAll = [];

function csvToObjects(csv){
  const rows = csv.split(/\r?\n/).filter(r=>r.trim()!=="");
  if(!rows.length) return [];
  const header = rows.shift().split(',').map(h=>h.replace(/^"|"$/g,'').trim().toLowerCase());
  const idxNama = header.indexOf("nama file");
  const idxJenis = header.indexOf("jenis");
  const idxLink = header.indexOf("link file");
  const idxIkon = header.indexOf("ikon");

  return rows.map(line=>{
    const cols = line.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(c=>c.replace(/^"|"$/g,'').trim());
    return {
      nama: cols[idxNama] || "Tanpa Nama",
      jenis: cols[idxJenis] || "-",
      link: cols[idxLink] || "#",
      ikon: cols[idxIkon] || "üìÅ"
    };
  });
}

function highlight(text, q){
  if(!q) return text;
  const re = new RegExp(q,'ig');
  return text.replace(re, m=>`<mark class="hi">${m}</mark>`);
}

function render(list, q=""){
  const results = document.getElementById("results");
  const empty = document.getElementById("empty");
  results.innerHTML = "";

  if(!list.length){
    empty.style.display = "";
    results.style.display = "none";
    document.getElementById('footer').textContent = "Menampilkan 0 file | @pacegondes 2025";
    return;
  }

  empty.style.display = "none";
  results.style.display = "grid";
  list.forEach(item=>{
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <div class="icon">${item.ikon}</div>
      <div class="card-content">
        <div class="name">${highlight(item.nama, q)}</div>
        <div class="jenis">${highlight(item.jenis, q)}</div>
      </div>
      <a class="open-btn" href="${item.link}" target="_blank">Lihat</a>
    `;
    card.addEventListener("click", e=>{
      if(e.target.tagName === "A") return;
      window.open(item.link, "_blank");
    });
    results.appendChild(card);
  });

  document.getElementById('footer').textContent = `Menampilkan ${list.length} file | @pacegondes 2025`;
}

async function load(){
  try {
    const res = await fetch(CSV_URL);
    if(!res.ok) throw new Error("HTTP " + res.status);
    const txt = await res.text();
    dataAll = csvToObjects(txt);
    render(dataAll);
  } catch(e) {
    document.getElementById("results").innerHTML = `<div class="empty">Gagal ambil data: ${e.message}</div>`;
  }
}

function doSearch(){
  const q = document.getElementById("q").value.trim().toLowerCase();
  if(!q) {
    render(dataAll);
    return;
  }
  const filtered = dataAll.filter(x => 
    x.nama.toLowerCase().includes(q) ||
    x.jenis.toLowerCase().includes(q)
  );
  render(filtered, q);
}

document.getElementById("q").addEventListener("input", doSearch);
load();
</script>
</body>
</html>
